[tools]
python = "3.14"
"aqua:astral-sh/uv" = "0.9.2"

[env]
TG_API_ID = 123456
TG_API_HASH = "abcdefghijklmnopqrstuvwxyz"
TG_CHAT = "@username"
TG_SESSION = "telethon_session"
STREAM_SERVER = "rtmp://example.com/live/"
STREAM_KEY = "XXXX-XXXX-XXXX-XXXX"

[tasks.record_voice_call]
run = "uv run --script telegram_voice_relay.py {{env.TG_CHAT}} --output talk.mp3 --quality low --overwrite"

[tasks.telegram_to_youtube]
run = """uv run --script telegram_voice_relay.py {{env.TG_CHAT}} \
  --quality low \
  --live-cmd "ffmpeg -f s16le -ar {sample_rate} -ac {channels} -i pipe:0 \
      -stream_loop -1 -i black-loop.mp4 -c:v copy \
      -c:a aac -b:a 64k -threads 1 -f flv {{env.STREAM_SERVER}}{{env.STREAM_KEY}}"
"""

[tasks.generate_black_video]
run = "ffmpeg -y -f lavfi -i color=c=black:s=1280x720:r=30 -t 30 -c:v libx264 -preset veryfast -pix_fmt yuv420p -g 120 -keyint_min 120 -sc_threshold 0 black-loop.mp4"
